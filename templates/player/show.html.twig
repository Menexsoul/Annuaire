{% extends 'base.html.twig' %}

{% block title %}{{ player.Prenom }} {{ player.Nom }}{% endblock %}

{% block body %}
    <h1>{{ player.Prenom }} {{ player.Nom }}</h1>
        <img src="{{ asset('assets/uploads/players/' ~ (player.photo ?: 'default.png')) }}" alt="{{ player.Prenom }}" width="200">
    <p>Catégorie : {{ player.MaCategorie.Nom }}</p>
    <p>Niveau : {{ player.UnNiveau.nom }}</p>

{% if average %}
    <p><strong>Note moyenne :</strong> {{ average }}/5</p>
{% endif %}

    <hr>
    <h3>Avis des utilisateurs :</h3>

{% for review in reviews %}
    <div class="review" style="border-bottom: 1px solid #ddd; padding: .5rem 0;">
        <p>⭐ {{ review.rating }}/5 — par {{ review.UnUtilisateur }} le {{ review.createdAt|date('d/m/Y') }}</p>
        <p>{{ review.comment }}</p>
    </div>
{% else %}
    <p>Aucun avis pour ce joueur.</p>
{% endfor %}

    <hr>

{% if app.user %}
        {% if form is defined and form is not null %}
            <h3>Laisser un avis</h3>
            {{ form_start(form, {'action': path('app_player_review', {'id': player.id})}) }}
            {{ form_row(form.rating) }}
            {{ form_row(form.comment) }}
            <button class="btn btn-primary">Envoyer</button>
            {{ form_end(form) }}
        {% else %}
            <p>Vous avez déjà donné un avis pour ce joueur.</p>
        {% endif %}
    {% else %}
    <p><a href="{{ path('app_login') }}">Connectez-vous</a> pour laisser un avis.</p>
    {% endif %}
{% endblock %}
